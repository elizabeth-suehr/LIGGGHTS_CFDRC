atom_modify       map array

processors        4 4 2

# Set domain
region            domain block 0.0 5.04000e-03 0.0 5.04000e-03 0.0 2.52000e-03 units box volume_limit 1e-16
create_box        2 domain
Created orthogonal box = (0 0 0) to (0.00504 0.00504 0.00252)
  4 by 4 by 2 MPI processor grid

# Set neighbor and list options
neighbor          1.721e-04 bin
neigh_modify      every 1 delay 0 check no contact_distance_factor 1.1e+00

# Set particle properties
hard_particles    yes
fix               m1 all property/global youngsModulus peratomtype 8.70000e+09 8.70000e+09
fix               m2 all property/global poissonsRatio peratomtype 0.3 0.3
fix               m3 all property/global coefficientRestitution peratomtypepair 2 0.95 0.975 0.975 1.0
fix               m4 all property/global coefficientFriction peratomtypepair 2 0.0 0.0 0.0 0.0
fix               m5 all property/global coefficientRollingFriction peratomtypepair 2 0.0 0.0 0.0 0.0

# Set collision models and time step
pair_style        gran model hertz tangential history
pair_coeff        * *
timestep          1.0000e-16

# Set up particle templates, distributions, and groups
group             nve_group1 region domain
0 atoms in group nve_group1
fix               pts1 nve_group1 particletemplate/multisphere 123457 atom_type 1 volume_limit 1e-18 density constant 2500.000 nspheres 93 ntry 10000000 spheres file multisphere93.txt scale 1.0 type 1
Finished calculating properties of template
   mass = 2.760772e-08, radius of bounding sphere = 1.391000e-04, radius of equivalent sphere = 1.381446e-04
   center of mass = 0.000000e+00, 0.000000e+00, 0.000000e+00
   center of bounding sphere in body coords = -1.767384e-08, -6.601520e-09, 2.552590e-08
   Principal moments of inertia_: 2.104960e-16, 2.106500e-16, 2.106852e-16
     Eigenvector: 9.218533e-01, 3.633681e-02, -3.858317e-01
     Eigenvector: -2.065396e-01, 8.884841e-01, -4.098017e-01
     Eigenvector: 3.279145e-01, 4.574666e-01, 8.265570e-01
     Inertia tensor: 2.105229e-16, 1.304116e-22, 6.431148e-20
     Inertia tensor: 1.304116e-22, 2.106571e-16, 1.548612e-20
     Inertia tensor: 6.431148e-20, 1.548612e-20, 2.106511e-16
fix               pdd1 nve_group1 particledistribution/discrete 15485867 1 pts1 1.0
# Set up particle insertion
fix               ins1 nve_group1 insert/pack seed 32452867 distributiontemplate pdd1 maxattempt 3 vel constant 0. 0. 0.                   omega constant 0. 0. 0. insert_every once overlapcheck yes all_in yes region domain ntry_mc 100000000 volumefraction_region 0.5
# Apply integration fix
fix               ms nve_group1 multisphere

# Make ymin and ymax temporary walls
# Make collisions elastic, set velocity to zero, and repeat to eliminate overlaps
fix               m3 all property/global coefficientRestitution peratomtypepair 2 0.1 0.1 0.1 0.1
# Run one step to get particles inserted
thermo_style      custom step
run               1
Setting up run at Fri Sep  8 10:30:32 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1524)
INFO: Particle insertion ins1: inserting every 0 steps
Memory usage per processor = 8.45116 Mbytes
    Step 
       0 
INFO: Particle insertion ins1: inserted 2899 particle templates (mass 8.003477e-05) at step 1
 - a total of 2899 particle templates (mass 8.003477e-05) inserted so far.
       1 
Loop time of 0.600141 on 32 procs for 1 steps with 269607 atoms, finish time Fri Sep  8 10:30:37 2023


Pair  time (%) = 0.11804 (19.6688)
Neigh time (%) = 0.309231 (51.5264)
Comm  time (%) = 0.0199113 (3.31777)
Outpt time (%) = 0.0925137 (15.4153)
Other time (%) = 0.0604444 (10.0717)

Nlocal:    8425.22 ave 9726 max 7304 min
Histogram: 5 3 0 3 9 4 0 0 5 3
Nghost:    25625.4 ave 30815 max 21435 min
Histogram: 3 3 3 6 6 2 2 2 4 1
Neighs:    4.2396e+06 ave 5.66024e+06 max 3.00259e+06 min
Histogram: 2 4 1 10 4 3 0 1 4 3

Total # of neighbors = 135667281
Ave neighs/atom = 503.204
Neighbor list builds = 1
Dangerous builds = 0

group             nve_group union nve_group1
269607 atoms in group nve_group

# Make collisions elastic, set velocity to zero, and repeat to eliminate overlaps
fix               m3 all property/global coefficientRestitution peratomtypepair 2 0.1 0.1 0.1 0.1
variable          vzero atom 0.0
# Run briefly to eliminate potential overlaps
fix               limcheck all slowinit xmax 5.35e-06 reset 1000 threshold 1.00e-06 start_dt 2.616e-11 end_dt 1.570e-08
run               100000
Setting up run at Fri Sep  8 10:30:37 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1524)
Memory usage per processor = 159.4 Mbytes
    Step 
       1 
  100001 
Loop time of 47856.8 on 32 procs for 100000 steps with 269607 atoms, finish time Fri Sep  8 23:48:14 2023


Pair  time (%) = 7800.19 (16.299)
Neigh time (%) = 25879.3 (54.0765)
Comm  time (%) = 802.058 (1.67595)
Outpt time (%) = 0.0698454 (0.000145947)
Other time (%) = 13375.2 (27.9483)

Nlocal:    8425.22 ave 9680 max 7333 min
Histogram: 5 3 1 4 6 4 2 1 2 4
Nghost:    26824.5 ave 30970 max 22363 min
Histogram: 2 4 2 0 9 5 2 0 3 5
Neighs:    4.24403e+06 ave 5.51638e+06 max 3.24531e+06 min
Histogram: 6 2 1 6 7 2 0 2 2 4

Total # of neighbors = 135809075
Ave neighs/atom = 503.73
Neighbor list builds = 100000
Dangerous builds = 0

# Set restitution and velocity for granular temperature
fix               m3 all property/global coefficientRestitution peratomtypepair 2 0.95 0.975 0.975 1.0
unfix             limcheck
# Set the top/bottom boundaries as LE
timestep          1.5697e-09

fix               leboundary all lebc 100.0 true gtemp 1.00e-06

# Run desired simulation
info time
run 10000
Setting up run at Fri Sep  8 23:48:14 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1524)
Memory usage per processor = 159.808 Mbytes
    Step 
  100001 
  110001 
Loop time of 4677.06 on 32 procs for 10000 steps with 269607 atoms, finish time Sat Sep  9 01:06:12 2023


Pair  time (%) = 759.058 (16.2294)
Neigh time (%) = 2745.52 (58.7018)
Comm  time (%) = 137.361 (2.93691)
Outpt time (%) = 0.0516312 (0.00110392)
Other time (%) = 1035.07 (22.1308)

Nlocal:    8425.22 ave 9086 max 7048 min
Histogram: 3 0 2 1 1 2 4 6 4 9
Nghost:    32489.2 ave 42513 max 25610 min
Histogram: 8 8 0 0 4 0 3 5 0 4
Neighs:    4.76876e+06 ave 5.70152e+06 max 3.26335e+06 min
Histogram: 4 0 2 2 0 2 8 4 4 6

Total # of neighbors = 152600269
Ave neighs/atom = 566.01
Neighbor list builds = 10000
Dangerous builds = 0
info time
run 10000
Setting up run at Sat Sep  9 01:06:12 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1524)
Memory usage per processor = 205.318 Mbytes
    Step 
  110001 
  120001 
Loop time of 4513.14 on 32 procs for 10000 steps with 269607 atoms, finish time Sat Sep  9 02:21:25 2023


Pair  time (%) = 755.638 (16.743)
Neigh time (%) = 2701.46 (59.8576)
Comm  time (%) = 131.869 (2.92189)
Outpt time (%) = 0.0488327 (0.00108201)
Other time (%) = 924.127 (20.4763)

Nlocal:    8425.22 ave 9073 max 7219 min
Histogram: 3 1 1 2 0 3 4 5 10 3
Nghost:    32431.7 ave 42510 max 26129 min
Histogram: 9 7 0 0 4 0 3 5 0 4
Neighs:    4.79476e+06 ave 5.66434e+06 max 3.4985e+06 min
Histogram: 4 1 2 1 0 3 7 6 4 4

Total # of neighbors = 153432198
Ave neighs/atom = 569.096
Neighbor list builds = 10000
Dangerous builds = 0
